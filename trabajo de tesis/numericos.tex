\chapter{Métodos numéricos}
\section{COMSOL: método de elementos finitos}
A partir de la ecuación (\ref{eqn:rotordoble}) y separando el campo eléctrico $\textbf{E}(\textbf{r}) = \textbf{E}_1(\textbf{r}) e^{-i \phi_1 (\textbf{r})}$ en una envolvente lenta $\textbf{E}_1(\textbf{r})$ y una fase rápidamente oscilante $\phi_1 (\textbf{r})$ ,

\begin{align}
\nabla\times[\nabla\times(\textbf{E}_1 e^{-i \phi_1 })] &=  n^2k_0^2 \textbf{E}_1 e^{-i \phi_1} \nonumber
\\
\nabla\times[ e^{-i \phi_1} \times (\nabla \times \textbf{E}_1) + \nabla(e^{-i \phi_1})\times \textbf{E}_1] &=  n^2k_0^2 \textbf{E}_1 e^{-i \phi_1}\nonumber
\\
\nabla\times[ e^{-i \phi_1}  (\nabla  - i  \textbf{k} _1)\times\textbf{E}_1  ] &=  n^2k_0^2 \textbf{E}_1 e^{-i \phi_1}\nonumber
\\
e^{-i \phi_1}  \nabla\times[ (\nabla  - i  \textbf{k} _1)\times\textbf{E}_1] + \nabla(e^{-i \phi_1})\times  (\nabla  - i  \textbf{k} _1)\times\textbf{E}_1  &=  n^2k_0^2 \textbf{E}_1 e^{-i \phi_1}\nonumber
\\
e^{-i \phi_1}  \nabla\times[ (\nabla  - i  \textbf{k} _1)\times\textbf{E}_1] - i\textbf{k}_1 e^{-i \phi_1}\times  (\nabla  - i  \textbf{k} _1)\times\textbf{E}_1  &=  n^2k_0^2 \textbf{E}_1 e^{-i \phi_1}\nonumber
\\
	(\nabla-i\textbf{k}_1)\times((\nabla-i\textbf{k}_1)\times \textbf{E}_1) &= n^2k_0^2 \textbf{E}_1,
	 \label{eqn:comsol}
\end{align}
con $\textbf{k}_1 = \nabla\phi_1(\textbf{r})$.
El software comercial COMSOL \textit{Multiphysics} puede integrar numéricamente la ecuación (\ref{eqn:comsol})  mediante elementos finitos más gruesos que los que se tendría que usar a partir de la ecuación (\ref{eqn:rotordoble}) debido a la separación entre envolvente y fase, sin haber hecho aproximación alguna.

\section{Expansión en modos normales}

\section{Beam Propagation Method} 

Por otro lado, utilizando la aproximación paraxial escogiendo el eje $z$  como dirección de propagación y seleccionando la polarización horizontal del campo, es posible simplificar la ecuación (\ref{eqn:comsol}) y llegar a la formulación de un método numérico escalar conocido como \textit{Beam Propagation Method}, utilizado ampliamente en esta área de investigación \cite{bics, interorbital, OAMCaging, vortex, bpm}. Éste consiste en resolver numéricamente la ecuación
\begin{equation}
	2in_0k_0\frac{\partial}{\partial z}\psi(x,y,z) = \nabla_\perp^2 \psi (x,y,z) + \left(n^2-n_0^2\right)k_0^2 \psi (x,y,z), \label{eqn:paraxial}
\end{equation}
con $\psi(x,y,z)$, $n_0$, $n(x,y)$ y $k_0$ la envolvente de la componente horizontal campo eléctrico, el índice de refracción del material, el índice de refracción inducido y el número de onda en el vacío, respectivamente. 



\section{Ecuaciones dinámicas discretas tipo Schrödinger}

Aplicando teoría acoplada de modos \cite{coupledmodetheory} a la ecuación (\ref{eqn:paraxial}), con el objetivo de describir de forma discreta una red fotónica, es posible derivar las llamadas ecuaciones discretas tipo Schrödinger \cite{discretesolitons, artificialFB, FBdynamics}
\begin{equation}
	\frac{d }{d z} |a\rangle  = i\hat{C} |a\rangle, \label{eqn:CMT_mat}
\end{equation}
donde utiliza la notación de Dirac para liberar a la ecuación (\ref{eqn:CMT1}) de alguna elección particular de base, con $a_{\mu, m'} \equiv \langle \mu, m' | a \rangle$.
